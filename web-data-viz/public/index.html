<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gatices</title>
    <link
      rel="shortcut icon"
      href="./assets/images/favicon.png"
      type="image/x-icon"
    />
    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/styles.css" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css"
      integrity="sha512-Kc323vGBEqzTmouAECnVceyQqyqdsSiqLQISBL29aUW4U/M7pSPA/gEUZQqv1cwx4OnYxTxve5UMg5GT6L4JJg=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />

    <link
      href="https://unpkg.com/nes.css/css/nes-core.min.css"
      rel="stylesheet"
    />
  </head>
  <body onload="listar(); verificarGato()">
    <main>
      <header>
        <img class="logo" src="./assets/images/logo.png" alt="" />
        <nav>
          <ul>
            <a href="#inicio">
              <div>
                <li>Início</li>
              </div>
            </a>
            <a href="#sobre">
              <div>
                <li>Sobre</li>
              </div>
            </a>
            <a href="#curiosidades">
              <div>
                <li>Curiosidades</li>
              </div>
            </a>
            <a href="#crie-seu-gato">
              <div>
                <li>Crie seu gato</li>
              </div>
            </a>
            <a href="#fale-conosco">
              <div>
                <li>Fale conosco</li>
              </div>
            </a>
            <div class="links-login-cadastro" id="sessaoLogin">
              <a href="./login.html">
                <p>Entrar</p>
              </a>
              <span>|</span>
              <a href="./cadastro.html">
                <p>Criar conta</p>
              </a>
            </div>
            <div class="saudacao" id="saudacao">
              <h1>Miauu, <span id="b_usuario"></span>!</h1>
              <a onclick="sair()">
                <i class="fa-solid fa-arrow-right-from-bracket"></i>
              </a>
            </div>
          </ul>
        </nav>
      </header>

      <section class="parallax parallax-bg"></section>
      <section class="inicio" id="inicio">
        <img class="gatinho" src="./assets/images/gatinho-rosa.png" alt="" />
        <img class="gatinho2" src="./assets/images/gatinho-rosa.png" alt="" />
        <div class="conteudo-inicio">
          <h1>Seja bem-vindo à Gatices!</h1>
          <p>
            Aqui é o lugar perfeito para todos que amam o universo dos gatinhos!
            Prepare-se para explorar conteúdos repletos de fofura, dicas de
            cuidado, curiosidades e muita diversão sobre esses pequenos felinos.
            Quer você seja um tutor apaixonado ou apenas um admirador dos
            encantos felinos, sinta-se em casa e deixe-se levar pelas patinhas
            que vão guiá-lo em cada página. Entre, descubra e aproveite –
            afinal, gatos tornam a vida mais leve e feliz!
          </p>
        </div>
      </section>
      <section>
        <div class="sobre" id="sobre">
          <div class="conteudo-sobre">
            <h1>Sobre Nós</h1>
            <p>
              Bem-vindo ao nosso espaço dedicado aos adoráveis gatinhos! Aqui,
              acreditamos que esses pequenos felinos não são apenas pets, mas
              verdadeiros membros da família que trazem alegria e amor para
              nossas vidas.
            </p>
            <h2>Nossa Missão</h2>
            <p>
              Nossa missão é celebrar a beleza, a curiosidade e a personalidade
              única de cada gatinho. Oferecemos informações valiosas sobre
              cuidados, saúde e comportamento, além de dicas sobre como criar um
              ambiente acolhedor para seu amigo felino. Acreditamos que cada
              gatinho merece um lar cheio de carinho e atenção.
            </p>
          </div>
        </div>
      </section>
      <section class="curiosidades" id="curiosidades">
        <div class="conteudo-curiosidades">
          <h1>Curiosidades!!!</h1>
          <h2>Você sabia?</h2>
          <ul>
            <li>
              Os gatos domésticos desenvolveram uma forma única de se comunicar
              com os humanos. Enquanto os felinos na natureza costumam usar
              vocalizações para se comunicar com outros animais, os gatos
              domésticos frequentemente "falam" apenas com os humanos,
              utilizando uma variedade de miados, ronronados e expressões
              faciais.
            </li>
            <li>
              Os gatos têm um ciclo de sono muito interessante. Eles dormem
              entre 12 a 16 horas por dia, e cerca de 70% desse sono é leve,
              permitindo que eles fiquem alertas a qualquer movimento ou som,
              mesmo enquanto descansam.
            </li>
            <li>
              Os gatos têm uma visão noturna excepcional, permitindo que vejam
              em ambientes com apenas 1/6 da luz necessária para que um humano
              enxergue. Isso é devido à presença de uma estrutura chamada
              "tapetum lucidum" em seus olhos, que reflete a luz e melhora a
              visão em condições de pouca luz.
            </li>
            <li>
              Os bigodes dos gatos não são apenas para estética. Eles são órgãos
              sensoriais altamente sensíveis que ajudam os gatos a medir espaços
              e detectar mudanças em seu ambiente, permitindo que percebam
              objetos e até mesmo correntes de ar.
            </li>
          </ul>
        </div>
        <img src="./assets/images/gatinho-rosa2.png" alt="" />
      </section>
      <section class="crie-seu-gato" id="crie-seu-gato">
        <div class="conteudo-crie-seu-gato">
          <h1>Crie o seu gato virtual!</h1>
        </div>
        <div class="card-container">
          <div class="selecao" id="div_selecao">
            <h1>Selecione o tipo de gato</h1>
            <div class="selecao-gatos">
              <img
                src="./assets/gatinhos-selecao/rosa.gif"
                onclick="selecionarGato('rosa')"
                style="
                  height: 90px;
                  width: 90px;
                  transform: translateY(40px);
                  margin-right: 15px;
                "
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/calico2.gif"
                onclick="selecionarGato('calico')"
                style="
                  height: 80px;
                  width: 70px;
                  transform: translateY(35px);
                  margin-right: 15px;
                "
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/cinza.gif"
                onclick="selecionarGato('cinza')"
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/branco.gif"
                onclick="selecionarGato('branco')"
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/laranja.gif"
                onclick="selecionarGato('laranja')"
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/roxo.gif"
                onclick="selecionarGato('roxo')"
                alt=""
              />
              <img
                src="./assets/gatinhos-selecao/preto.gif"
                onclick="selecionarGato('preto')"
                alt=""
              />
            </div>
          </div>
          <div class="info-gato" id="div_info_gato">
            <a onclick="mostrarSelecao()">
              <i class="fas fa-arrow-left"></i>
            </a>
            <h1>Digite o nome do seu gato</h1>
            <div class="campos">
              <input type="text" id="ipt_nome_gato" />
              <ul class="generos">
                <li class="genero masculino">
                  <input
                    type="radio"
                    class="feminino"
                    name="genero"
                    id="masc"
                    onclick="selecionarGenero('M')"
                  />
                  <img
                    class="check"
                    src="assets/images/check-icon.png"
                    alt=""
                  />
                  <label for="masc">Masculino</label>
                </li>
                <li class="genero feminino">
                  <input
                    type="radio"
                    class="masculino"
                    name="genero"
                    id="fem"
                    onclick="selecionarGenero('F')"
                  />
                  <img
                    class="check"
                    src="assets/images/check-icon.png"
                    alt=""
                  />
                  <label for="fem" class="icone-fem">Feminino</label>
                </li>
              </ul>
              <button class="btn-criar" onclick="cadastrar()">Criar</button>
            </div>
          </div>
          <div class="gato" id="div_gato">
            <div class="status">
              <h1>Nome: <span id="nome_gato"></span></h1>
              <h1>Genero: <span id="genero_gato"></span></h1>
              <h1>
                Fome: <span><progress></progress></span>
              </h1>
              <h1>Sede: <span id="sede_gato"></span></h1>
            </div>
            <div class="gif"></div>
          </div>
        </div>
      </section>
      <section class="fale-conosco" id="fale-conosco">
        <div class="conteudo-fale-conosco">
          <h1>Mande um miado</h1>
        </div>
        <div class="card-fale-conosco">
          <div class="campos">
            <p>Nome:</p>
            <input type="text" /><br />
            <p>Email:</p>
            <input type="email" /><br />
            <p>Mensagem:</p>
            <textarea name="" id=""></textarea><br />
            <button>Enviar</button>
          </div>
        </div>
        <img
          class="pixel-cat"
          src="./assets/images/pink-pixel-cat.png"
          alt=""
        />
        <img
          class="pixel-cat2"
          src="./assets/images/pink-pixel-cat.png"
          alt=""
        />
      </section>
      <footer>
        <div class="footer-container">
          <img src="./assets/images/logo.png" alt="" />
          <nav class="footer-nav">
            <ul>
              <a href="#inicio">
                <li>Início</li>
              </a>
              <span>|</span>
              <a href="#sobre">
                <li>Sobre</li>
              </a>
              <span>|</span>
              <a href="#curiosidades">
                <li>Curiosidades</li>
              </a>
              <span>|</span>
              <a href="#crie-seu-gato">
                <li>Crie seu gato</li>
              </a>
              <span>|</span>
              <a href="#fale-conosco">
                <li>Mande um miado</li>
              </a>
            </ul>
          </nav>
          <div class="social">
            <a href="">
              <i class="fa-brands fa-linkedin"></i>
            </a>
            <a href="https://instagram.com/nic.cs_">
              <i class="fa-brands fa-instagram"></i>
            </a>
            <a href="https://github.com/NiCoelho-tech">
              <i class="fa-brands fa-github"></i>
            </a>
          </div>
        </div>
        <p>© 2024 Gatices. Todos os direitos reservados.</p>
      </footer>
    </main>
    <script>
      b_usuario.innerHTML = sessionStorage.NOME_USUARIO;

      const login = sessaoLogin;
      const saudacaoUsuario = saudacao;

      let lista_gatos_cadastrados = [];

      if (sessionStorage.EMAIL_USUARIO && sessionStorage.NOME_USUARIO && sessionStorage.ID_GATO != null) {
        login.style.display = "none";
        saudacaoUsuario.style.display = "flex";
      } else if (sessionStorage.EMAIL_USUARIO && sessionStorage.NOME_USUARIO) {
        login.style.display = "none";
        saudacaoUsuario.style.display = "flex";
        div_selecao.style.display = "flex";
      } else {
        login.style.display = "flex";
        saudacaoUsuario.style.display = "none";
        div_selecao.style.display = "flex";
      }

      function sair() {
        sessionStorage.clear();
        window.location.reload();
      }

      var generoGato = "";
      var racaGato = "";

      function selecionarGato(gato) {
        const selecao = div_selecao;
        const infoGato = div_info_gato;

        racaGato = gato;
        selecao.style.display = "none";
        infoGato.style.display = "flex";
      }

      function selecionarGenero(genero) {
        generoGato = genero;
      }

      function mostrarSelecao() {
        const selecao = div_selecao;
        const infoGato = div_info_gato;

        selecao.style.display = "flex";
        infoGato.style.display = "none";
      }

      function cadastrar() {
        if (sessionStorage.EMAIL_USUARIO && sessionStorage.NOME_USUARIO) {
          var nomeGatoVar = ipt_nome_gato.value;
          var generoVar = generoGato;
          var racaVar = racaGato;
          var donoVar = sessionStorage.ID_USUARIO;

          div_info_gato.style.display = "none";
          div_gato.style.display = "flex";

          for (let i = 0; i < lista_gatos_cadastrados.length; i++) {
            if (lista_gatos_cadastrados[i].nomeGato == nomeGatoVar) {
              alert("Esse gato já existe!");
              return false;
            }
          }

          fetch("/gatos/cadastrar", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              nomeGatoServer: nomeGatoVar,
              generoServer: generoVar,
              racaServer: racaVar,
              donoServer: donoVar,
            }),
          })
            .then(function (resposta) {
              console.log("resposta: ", resposta);
              racaGato = "";
              masc.checked = false;
              fem.checked = false;
              ipt_nome_gato.value = "";

              if (resposta.ok) {
                console.log(resposta);
                console.log(donoVar);
              } else {
                throw "Houve um erro ao tentar realizar o cadastro!";
              }
            })
            .catch(function (resposta) {
              console.log(`#ERRO: ${resposta}`);
            });

          return false;
        } else {
          window.location = "/login.html";
        }
      }

      async function verificarGato() {
        try {
          const resposta = await fetch("/gatos/autenticar", {
            method: "POST",
            headers: {
              "Content-Type": "application/json",
            },
            body: JSON.stringify({
              idDonoServer: sessionStorage.ID_USUARIO,
            }),
          });

          if (!resposta.ok) {
            throw new Error("Erro ao autenticar o gato!");
          }

          const json = await resposta.json();

          console.log(json);
          console.log(JSON.stringify(json));

          sessionStorage.ID_GATO = json.id;
          sessionStorage.NOME_GATO = json.nome;
          sessionStorage.GENERO_GATO = json.genero;
          sessionStorage.RACA_GATO = json.raca;

          if (sessionStorage.EMAIL_USUARIO && sessionStorage.NOME_USUARIO && sessionStorage.ID_GATO != null) {
            const lista_racas = [
              "rosa",
              "calico",
              "cinza",
              "branco",
              "laranja",
              "roxo",
              "preto",
            ];

            const lista_cores = [
              "pink",
              "brown",
              "gray",
              "white",
              "orange",
              "purple",
              "black",
            ];

            let cor = 0;

            const nomeGato = sessionStorage.NOME_GATO;
            const generoGato = sessionStorage.GENERO_GATO;
            const racaGato = sessionStorage.RACA_GATO;

            div_selecao.style.display = "none";
            div_info_gato.style.display = "none";
            div_gato.style.display = "flex";

            nome_gato.textContent = nomeGato;
            genero_gato.textContent =
            generoGato === "M" ? "Masculino" : "Feminino";

            for (let i = 0; i < lista_racas.length; i++) {
              if (racaGato === lista_racas[i]) {
                cor = lista_cores[i];
                break;
              }
            }

            div_gato.style.backgroundColor = cor;
          }
        } catch (erro) {
          console.log(`Erro: ${erro.message}`);
        }
      }

      function listar() {
        fetch("/gatos/listar", {
          method: "GET",
        })
          .then(function (resposta) {
            resposta.json().then((gatos) => {
              gatos.forEach((gatos) => {
                lista_gatos_cadastrados.push(gatos);
              });
            });
          })
          .catch(function (resposta) {
            console.log(`#ERRO: ${resposta}`);
          });
      }
    </script>
  </body>
</html>
